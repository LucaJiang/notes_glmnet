#
#
install.packages("lars")
library(lars)
data(diabetes)
install.packages("glmnet")
library(glmnet)
#
#
#
# Fit the LARS model
lars_fit <- lars(diabetes$x, diabetes$y, type = "lasso")
stage_fit <- lars(diabetes$x, diabetes$y, type = "forward.stagewise")
step_fit <- lars(diabetes$x, diabetes$y, type = "stepwise")
lar_fit <- lars(diabetes$x, diabetes$y, type = "lar")

glmnet_lasso_fit <- glmnet(diabetes$x, diabetes$y, alpha = 1)
#
#
#
pdf("./img/lars_diabetes.pdf", width = 12, height = 8)
par(mfrow = c(1, 3))
plot(lar_fit, xvar = "norm", col = 1:ncol(diabetes$x), lwd = 2)
plot(lars_fit, xvar = "norm", col = 1:ncol(diabetes$x), lwd = 2)
plot(stage_fit, xvar = "norm", col = 1:ncol(diabetes$x), lwd = 2)
dev.off()
#
#
#
plot(lars_fit, xvar = c("norm", "df", "arc.length", "step"), breaks = TRUE, plottype = "Cp")
#
#
#
#
# install.packages("microbenchmark")
library(microbenchmark)
cmp <- microbenchmark(lars(diabetes$x, diabetes$y, type = "lar"),
    lars(diabetes$x, diabetes$y, type = "lasso"),
    lars(diabetes$x, diabetes$y, type = "stepwise"),
    lars(diabetes$x, diabetes$y, type = "forward.stagewise"),
    # glmnet(diabetes$x, diabetes$y, alpha = 1),
    times = 100
)
cmp_log <- cmp
cmp_log$time <- log(cmp$time)
# plot the comparison
library(ggplot2)
pdf("./img/lars_time.pdf", width = 6, height = 6)
ggplot(cmp, aes(x = expr, y = log(time, base = 10), fill = expr)) +
    geom_boxplot(alpha = 0.6) +
    theme(legend.position = "none") +
    scale_fill_brewer(palette = "Dark2") +
    ylab("Log Computation Time (ms)") +
    xlab("Method") +
    ggtitle("Computation Time Comparison") +
    scale_x_discrete(labels = c("LAR", "LAR.lasso", "Stepwise", "Stagewise"))
# boxplot(cmp, names = c("LAR", "LAR.lasso", "Stepwise", "Stagewise"), ylab = "Log(Computation Time)", xlab = "Method")
dev.off()
#
#
#
#
